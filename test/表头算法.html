<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        var ths = [{
            "id": "1584",
            "name": "乡镇/街道",
            "lastColumnName": "column1584",
            "pId": "-1",
            "columnType": null,
            "sort": 1584,
            "rowNum": "2",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1585",
            "name": "治安安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1585,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1586",
            "name": "生态安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1586,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1587",
            "name": "食品药品安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1587,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1588",
            "name": "交通安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1588,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1589",
            "name": "消防安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1589,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1590",
            "name": "生产安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1590,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1591",
            "name": "综合安全感",
            "lastColumnName": null,
            "pId": "-1",
            "columnType": null,
            "sort": 1591,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 4,
            "isLast": 0,
            "delFlag": 0
        }, {
            "id": "1592",
            "name": "安全",
            "lastColumnName": "column1592",
            "pId": "1585",
            "columnType": null,
            "sort": 1592,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1593",
            "name": "比较安全",
            "lastColumnName": "column1593",
            "pId": "1585",
            "columnType": null,
            "sort": 1593,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1594",
            "name": "不太安全",
            "lastColumnName": "column1594",
            "pId": "1585",
            "columnType": null,
            "sort": 1594,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1595",
            "name": "不安全",
            "lastColumnName": "column1595",
            "pId": "1585",
            "columnType": null,
            "sort": 1595,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1596",
            "name": "满意",
            "lastColumnName": "column1596",
            "pId": "1586",
            "columnType": null,
            "sort": 1596,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1597",
            "name": "比较满意",
            "lastColumnName": "column1597",
            "pId": "1586",
            "columnType": null,
            "sort": 1597,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1598",
            "name": "不太满意",
            "lastColumnName": "column1598",
            "pId": "1586",
            "columnType": null,
            "sort": 1598,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1599",
            "name": "不满意",
            "lastColumnName": "column1599",
            "pId": "1586",
            "columnType": null,
            "sort": 1599,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1600",
            "name": "满意",
            "lastColumnName": "column1600",
            "pId": "1587",
            "columnType": null,
            "sort": 1600,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1601",
            "name": "比较满意",
            "lastColumnName": "column1601",
            "pId": "1587",
            "columnType": null,
            "sort": 1601,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1602",
            "name": "不太满意",
            "lastColumnName": "column1602",
            "pId": "1587",
            "columnType": null,
            "sort": 1602,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1603",
            "name": "不满意",
            "lastColumnName": "column1603",
            "pId": "1587",
            "columnType": null,
            "sort": 1603,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1604",
            "name": "安全",
            "lastColumnName": "column1604",
            "pId": "1588",
            "columnType": null,
            "sort": 1604,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1605",
            "name": "比较安全",
            "lastColumnName": "column1605",
            "pId": "1588",
            "columnType": null,
            "sort": 1605,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1606",
            "name": "不太安全",
            "lastColumnName": "column1606",
            "pId": "1588",
            "columnType": null,
            "sort": 1606,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1607",
            "name": "不安全",
            "lastColumnName": "column1607",
            "pId": "1588",
            "columnType": null,
            "sort": 1607,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1608",
            "name": "满意",
            "lastColumnName": "column1608",
            "pId": "1589",
            "columnType": null,
            "sort": 1608,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1609",
            "name": "比较满意",
            "lastColumnName": "column1609",
            "pId": "1589",
            "columnType": null,
            "sort": 1609,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1610",
            "name": "不太满意",
            "lastColumnName": "column1610",
            "pId": "1589",
            "columnType": null,
            "sort": 1610,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1611",
            "name": "不满意",
            "lastColumnName": "column1611",
            "pId": "1589",
            "columnType": null,
            "sort": 1611,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1612",
            "name": "（交通安全感+消防安全感）/2",
            "lastColumnName": "column1612",
            "pId": "1590",
            "columnType": null,
            "sort": 1612,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1613",
            "name": "安全",
            "lastColumnName": "column1613",
            "pId": "1591",
            "columnType": null,
            "sort": 1613,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1614",
            "name": "基本安全",
            "lastColumnName": "column1614",
            "pId": "1591",
            "columnType": null,
            "sort": 1614,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1615",
            "name": "不太安全",
            "lastColumnName": "column1615",
            "pId": "1591",
            "columnType": null,
            "sort": 1615,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "1616",
            "name": "不安全",
            "lastColumnName": "column1616",
            "pId": "1591",
            "columnType": null,
            "sort": 1616,
            "rowNum": "1",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "158401",
            "name": "时间",
            "lastColumnName": "column158401",
            "pId": "-1",
            "columnType": null,
            "sort": 1616.001,
            "rowNum": "2",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }, {
            "id": "161601",
            "name": "备注",
            "lastColumnName": "column161601",
            "pId": "-1",
            "columnType": null,
            "sort": 1616.01,
            "rowNum": "2",
            "categoryId": "94EE20DEF449D97EE05011AC070008AE",
            "colNum": 1,
            "isLast": 1,
            "delFlag": 0
        }]
        setColumns(ths)

        function setColumns(tableHead, result) {
            var result = [];
            for (var i = 0; i < tableHead.length; i++) {
                var value = tableHead[i]
                if (value.isLast == 1) {
                    result.push(value)
                    tableHead.splice(i, 1);
                    i--;
                }
            }
            result.forEach(function (value) {
                if (value.pId != -1) {
                    value.group = [];
                    setGroup(tableHead, value.pId, value.group)
                }
            })

            return result
        }

        function setGroup(arr, pId, group) {
            group = group ? group : [];
            arr.some(function (value) {
                if (value.id == pId) {
                    group.unshift(value.name);
                    if (value.pId && value.pId != -1) setGroup(arr, value.pId, group)
                    return true
                }
            })
        }
    </script>
</body>

</html>