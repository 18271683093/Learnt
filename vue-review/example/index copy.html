<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>demo</title>
    <link rel="stylesheet" href="./plugins/swiper/swiper.min.css">
    <link rel="stylesheet" href="./css/app.css">
</head>

<body>
    <div id="app">
        

    </div>




    <template id="m-swiper">
        <div ref="swiper-container" class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide" v-for="(value,index) in data" :key="index">
                    <slot v-bind="value"> </slot>
                </div>
            </div>
            <div class="swiper-pagination" v-show="params.pagination && data.length>0"></div>
            <div class="swiper-button-prev" v-show="params.navigation && data.length>0"></div>
            <div class="swiper-button-next" v-show="params.navigation && data.length>0"></div>
            <div class="swiper-scrollbar" v-show="params.scrollbar && data.length>0"></div>
        </div>
    </template>

    <template id="m-card">
        <div class="slot-area btn">
            <slot v-bind="value">
                {{value}}
            </slot>
        </div>
    </template>

    <script src="./js/require.min.js"></script>
    <script src="./js/require-config.js"></script>
    <script>
        require(['vue', 'router', 'dynamicRouter', 'mComponents'], function (Vue, router, dynamicRouter, mComponents) {
            var routes = [
                {
                    path: '/foo', name: "foo", meta: {
                        name: "foo",
                        auth: true,
                        roles: ["foo"]
                    },
                    component: { template: "<span>foo</span>" },
                    children: [
                        {
                            path: 'zoo',
                            name: "zoo",
                            meta: {
                                name: "zoo",
                                auth: true,
                                roles: ["foo"]
                            },
                            component: { template: "<span>zoo</span>" },
                        }
                    ]
                },
                {
                    path: '/bar', name: "bar",
                    meta: {
                        name: "bar",
                        auth: true,
                        roles: ["bar"],
                        isChild: true
                    },
                    component: { template: "<span>bar</span>" },
                    children: [
                        {
                            path: 'boo',
                            name: "boo",
                            meta: {
                                name: "boo",
                                auth: true,
                                roles: ["bar"],
                                isChild: true
                            },
                            component: { template: "<span>boo</span>" },
                        }
                    ]
                }
            ];
            var vm = new Vue({
                el: "#app",
                router: router,
                mixins: [dynamicRouter],
                data: {
                    path: [],
                    text: "",
                    config: {
                        // autoplay: true,
                        slidesPerView: 2,
                        direction: "horizontal",
                        loop: false,
                        pagination: true,
                        navigation: true,
                        scrollbar: false
                    },
                    data: [],
                    dynamicAllRouters: routes
                },

                methods: {
                    jumpTo(router) {
                        this.$router.push(router);
                        this.path.push(router);
                    },
                    navigateto(router, index, len) {
                        var idx = index + 1, goIdx = idx - len;
                        if (idx === len) return;// 点击的是 当前路由 
                        this.path = this.path.slice(0, idx);
                        this.$router.go(goIdx);
                    },
                    slideChange: function (swiper) {
                        // console.log(swiper)
                    },
                    changeSlide: function () {
                        this.$addRoutes(routes)
                    },
                    changeConfig: function () {
                        this.config.pagination = false;
                    },
                    chose(value) {
                        console.log(value)
                        this.text = value.text
                    },
                    beforeEach(to, from, next) {
                        console.log(to)
                        next()
                    },
                    monitorWHistory() {

                        if (window.history && window.history.pushState) {
                            //监听浏览器前进后退事件
                            window.addEventListener('popstate', function () {
                                //do something...
                                console.log(history);
                            });

                        }
                    }
                },
                mounted() {
                    this.monitorWHistory()
                },
                beforeUpdate() {
                    console.log('root beforeUpdate')
                },
                updated() {
                    console.log('root updated')
                },
            })
        })

    </script>

</body>

</html>